@{
    ViewBag.Title = "All Rubrics";
    Layout = "~/Views/Shared/_AdministratorLayout.cshtml";
}

<form role="form">
    <br/>
    <div class="form-group">
        
            @Html.Label("Select Department")
        
       
            @Html.DropDownList("DEPARTMENT", new SelectList(ViewBag.Departments, "Value", "Text"), new
            {
                onchange = @"
                getPerformanceIndicator(this.value)
                "
            }
        )
        
    </div>
    


    <div id="PIndicator">

    </div>

    <div class="form-group">
        <div class="col-md-10">
            <input type="button" value="Search" class="btn btn-primary" onclick="getRubricTable(this);" />
        </div>
    </div>
</form>
<br/>
<div id="Rubric">

</div>


@Scripts.Render("~/bundles/jquery")

<script>
    function getPerformanceIndicator(deptValue) {
        var tbl = $('#PIndicator');
        if (deptValue == "default") {
            alert("please Select appropriate department");
            tbl.empty();
        }
        else {
            $.ajax({
                url: '/Rubric/GetPerformanceIndicator?dept=' + deptValue,
                contentType: 'application/html ; charset:utf-8',
                type: 'GET',
                dataType: 'html'
            }).success(function (result) {

                tbl.empty().append(result);
            }).error(function () {
            });
        }
    }

    function getRubricTable(btnClicked) {
        var $form = $(btnClicked).parents('form');
        var tbl = $('#Rubric');
        $.ajax({
            type: "POST",
            url: '/Rubric/Search/',
            data: $form.serialize(),
            error: function (xhr, status, error) {
                //do something about the error
                alert("Something went wrong")
            },
            success: function (response) {
                //do something with response
                tbl.empty().append(response);
            }
        });
    }
</script>
